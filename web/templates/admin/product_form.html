{{define "title"}}{{if .Product.ID}}Edit Product{{else}}New Product{{end}}{{end}}

{{define "content"}}
<div class="mx-auto max-w-4xl space-y-8">
    <!-- Back Link -->
    <div>
        <a href="/admin/products"
           class="inline-flex items-center gap-2 text-sm/6 text-zinc-500 hover:text-zinc-950 dark:text-zinc-400 dark:hover:text-white">
            ‚Üê Back to Products
        </a>
    </div>

    <!-- Page Header -->
    {{template "page-header" (dict
        "Title" (ternary .Product.ID.Valid "Edit Product" "New Product")
        "Description" "")}}

    <!-- Product Form -->
    <form method="POST"
          action="{{if .Product.ID}}/admin/products/{{.Product.ID}}/edit{{else}}/admin/products/new{{end}}"
          class="space-y-8">

        <!-- Basic Information -->
        <section class="rounded-2xl bg-white p-6 ring-1 ring-zinc-950/5 dark:bg-zinc-900 dark:ring-white/10">
            {{template "heading" (dict "Level" "3" "Content" "Basic Information")}}

            <div class="mt-6 space-y-6">
                <!-- Name -->
                {{template "field" (dict
                    "Label" "Product Name"
                    "Required" true
                    "Description" ""
                    "Input" (dict
                        "Type" "text"
                        "ID" "name"
                        "Name" "name"
                        "Required" true
                        "Value" .Product.Name
                        "Placeholder" "Ethiopian Yirgacheffe"))}}

                <!-- Slug -->
                {{template "field" (dict
                    "Label" "URL Slug"
                    "Required" true
                    "Description" "Used in the URL. Lowercase, hyphens only."
                    "Input" (dict
                        "Type" "text"
                        "ID" "slug"
                        "Name" "slug"
                        "Required" true
                        "Value" .Product.Slug
                        "Placeholder" "ethiopian-yirgacheffe"))}}

                <!-- Short Description -->
                {{template "field" (dict
                    "Label" "Short Description"
                    "Description" ""
                    "Input" (dict
                        "Type" "text"
                        "ID" "short_description"
                        "Name" "short_description"
                        "Value" (ternary .Product.ShortDescription.Valid .Product.ShortDescription.String "")
                        "Placeholder" "Bright and floral with notes of blueberry"))}}

                <!-- Description -->
                {{template "field" (dict
                    "Label" "Full Description"
                    "Description" ""
                    "Textarea" (dict
                        "ID" "description"
                        "Name" "description"
                        "Rows" 4
                        "Value" (ternary .Product.Description.Valid .Product.Description.String "")
                        "Placeholder" "Tell the story of this coffee..."))}}
            </div>
        </section>

        <!-- Coffee Attributes -->
        <section class="rounded-2xl bg-white p-6 ring-1 ring-zinc-950/5 dark:bg-zinc-900 dark:ring-white/10">
            {{template "heading" (dict "Level" "3" "Content" "Coffee Attributes")}}

            <div class="mt-6 grid gap-6 sm:grid-cols-2">
                <!-- Origin -->
                {{template "field" (dict
                    "Label" "Origin (Country)"
                    "Input" (dict
                        "Type" "text"
                        "ID" "origin"
                        "Name" "origin"
                        "Value" (ternary .Product.Origin.Valid .Product.Origin.String "")
                        "Placeholder" "Ethiopia"))}}

                <!-- Region -->
                {{template "field" (dict
                    "Label" "Region"
                    "Input" (dict
                        "Type" "text"
                        "ID" "region"
                        "Name" "region"
                        "Value" (ternary .Product.Region.Valid .Product.Region.String "")
                        "Placeholder" "Yirgacheffe"))}}

                <!-- Producer -->
                {{template "field" (dict
                    "Label" "Producer/Farm"
                    "Input" (dict
                        "Type" "text"
                        "ID" "producer"
                        "Name" "producer"
                        "Value" (ternary .Product.Producer.Valid .Product.Producer.String "")
                        "Placeholder" "Smallholder farmers"))}}

                <!-- Process -->
                {{template "field" (dict
                    "Label" "Process Method"
                    "Select" (dict
                        "ID" "process"
                        "Name" "process"
                        "Value" (ternary .Product.Process.Valid .Product.Process.String "")
                        "Options" (list
                            (dict "Value" "" "Label" "Select...")
                            (dict "Value" "washed" "Label" "Washed")
                            (dict "Value" "natural" "Label" "Natural")
                            (dict "Value" "honey" "Label" "Honey")
                            (dict "Value" "pulped_natural" "Label" "Pulped Natural")
                            (dict "Value" "anaerobic" "Label" "Anaerobic"))))}}

                <!-- Roast Level -->
                {{template "field" (dict
                    "Label" "Roast Level"
                    "Select" (dict
                        "ID" "roast_level"
                        "Name" "roast_level"
                        "Value" (ternary .Product.RoastLevel.Valid .Product.RoastLevel.String "")
                        "Options" (list
                            (dict "Value" "" "Label" "Select...")
                            (dict "Value" "light" "Label" "Light")
                            (dict "Value" "medium-light" "Label" "Medium-Light")
                            (dict "Value" "medium" "Label" "Medium")
                            (dict "Value" "medium-dark" "Label" "Medium-Dark")
                            (dict "Value" "dark" "Label" "Dark"))))}}

                <!-- Elevation Min -->
                {{template "field" (dict
                    "Label" "Elevation Min (meters)"
                    "Input" (dict
                        "Type" "number"
                        "ID" "elevation_min"
                        "Name" "elevation_min"
                        "Value" (ternary .Product.ElevationMin.Valid .Product.ElevationMin.Int32 "")
                        "Placeholder" "1800"))}}

                <!-- Elevation Max -->
                {{template "field" (dict
                    "Label" "Elevation Max (meters)"
                    "Input" (dict
                        "Type" "number"
                        "ID" "elevation_max"
                        "Name" "elevation_max"
                        "Value" (ternary .Product.ElevationMax.Valid .Product.ElevationMax.Int32 "")
                        "Placeholder" "2200"))}}

                <!-- Tasting Notes -->
                <div class="sm:col-span-2">
                    {{template "field" (dict
                        "Label" "Tasting Notes"
                        "Description" "Separate multiple notes with commas."
                        "Input" (dict
                            "Type" "text"
                            "ID" "tasting_notes"
                            "Name" "tasting_notes"
                            "Value" .TastingNotesString
                            "Placeholder" "blueberry, floral, citrus"))}}
                </div>
            </div>
        </section>

        <!-- Status & Visibility -->
        <section class="rounded-2xl bg-white p-6 ring-1 ring-zinc-950/5 dark:bg-zinc-900 dark:ring-white/10">
            {{template "heading" (dict "Level" "3" "Content" "Status & Visibility")}}

            <div class="mt-6 grid gap-6 sm:grid-cols-2">
                <!-- Status -->
                {{template "field" (dict
                    "Label" "Status"
                    "Required" true
                    "Select" (dict
                        "ID" "status"
                        "Name" "status"
                        "Required" true
                        "Value" .Product.Status
                        "Options" (list
                            (dict "Value" "draft" "Label" "Draft")
                            (dict "Value" "active" "Label" "Active")
                            (dict "Value" "archived" "Label" "Archived"))))}}

                <!-- Visibility -->
                {{template "field" (dict
                    "Label" "Visibility"
                    "Required" true
                    "Select" (dict
                        "ID" "visibility"
                        "Name" "visibility"
                        "Required" true
                        "Value" .Product.Visibility
                        "Options" (list
                            (dict "Value" "public" "Label" "Public")
                            (dict "Value" "wholesale" "Label" "Wholesale Only")
                            (dict "Value" "hidden" "Label" "Hidden"))))}}

                <!-- Sort Order -->
                {{template "field" (dict
                    "Label" "Sort Order"
                    "Description" "Lower numbers appear first."
                    "Input" (dict
                        "Type" "number"
                        "ID" "sort_order"
                        "Name" "sort_order"
                        "Value" .Product.SortOrder
                        "Placeholder" "0"))}}
            </div>
        </section>

        <!-- Form Actions -->
        <div class="flex justify-end gap-4">
            {{template "button" (dict
                "Content" "Cancel"
                "Variant" "outline"
                "Type" "button"
                "Href" "/admin/products")}}

            {{template "button" (dict
                "Content" (ternary .Product.ID.Valid "Update Product" "Create Product")
                "Variant" "solid"
                "Color" "zinc"
                "Type" "submit")}}
        </div>
    </form>

    <!-- Note about SKUs -->
    {{if .Product.ID}}
    <div class="rounded-2xl bg-blue-50 p-6 ring-1 ring-blue-600/20 dark:bg-blue-500/10 dark:ring-blue-500/20">
        <p class="text-sm/6 text-blue-900 dark:text-blue-300">
            <strong>Note:</strong> After saving, you can manage SKUs (sizes and grind options), pricing, and images from the product detail page.
        </p>
    </div>
    {{end}}
</div>
{{end}}
