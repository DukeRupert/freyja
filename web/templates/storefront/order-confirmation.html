{{define "title"}}Order Confirmed - Freyja Coffee{{end}}

{{define "content"}}
<div class="bg-neutral-50 min-h-screen">
  <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-12">

    {{if eq .Status "processing"}}
    <!-- Processing State -->
    <div class="text-center mb-10">
      <div class="inline-flex items-center justify-center w-20 h-20 bg-amber-500 rounded-full mb-6 shadow-sm animate-pulse">
        <svg class="w-12 h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
      </div>
      {{template "sf-heading" (dict "Level" "1" "Content" "Processing Your Order" "Class" "mb-3")}}
      <p class="text-base text-neutral-600 mb-6">
        Your payment was successful! We're processing your order now.
      </p>
      <p class="text-sm text-neutral-500">
        This page will automatically refresh when your order is ready.
      </p>
    </div>

    <script>
      // Poll for order completion every 2 seconds
      setTimeout(function() {
        window.location.reload();
      }, 2000);
    </script>

    {{else if eq .Status "succeeded"}}
    <!-- Success Header -->
    <div class="text-center mb-10">
      <div class="inline-flex items-center justify-center w-20 h-20 bg-teal-700 rounded-full mb-6 shadow-sm">
        <svg class="w-12 h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 13l4 4L19 7"/>
        </svg>
      </div>
      {{template "sf-heading" (dict "Level" "1" "Content" "Order Confirmed" "Class" "mb-3")}}
      <p class="text-base text-neutral-600">
        We've received your order and will send a confirmation email to
        <span class="font-medium text-neutral-900">{{.Order.Email}}</span>
      </p>
    </div>

    <!-- Order Details Card -->
    <div class="bg-white border border-neutral-200 rounded-lg shadow-sm p-8 mb-6">

      <!-- Order Number & Date -->
      <div class="mb-6 pb-6 border-b border-neutral-200">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
          <div>
            <p class="text-xs text-neutral-600 mb-1">Order number</p>
            <p class="text-lg font-semibold text-neutral-900">{{.Order.OrderNumber}}</p>
          </div>
          <div>
            <p class="text-xs text-neutral-600 mb-1">Order date</p>
            <p class="text-sm text-neutral-900">{{.Order.CreatedAt.Format "January 2, 2006"}}</p>
          </div>
        </div>
      </div>

      <!-- Order Items -->
      <div class="mb-6">
        <h2 class="text-base font-medium text-neutral-900 mb-4">Items Ordered</h2>
        <div class="space-y-4">
          {{range .Items}}
          <div class="flex gap-4">
            <!-- Product Image Placeholder -->
            <div class="w-16 h-16 flex-shrink-0 bg-neutral-100 rounded overflow-hidden flex items-center justify-center">
              <svg class="w-6 h-6 text-neutral-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
              </svg>
            </div>

            <!-- Item Details -->
            <div class="flex-1 min-w-0">
              <h3 class="text-sm font-medium text-neutral-900">{{.ProductName}}</h3>
              <p class="text-xs text-neutral-600 mt-1">{{.SKU}}</p>
              <p class="text-xs text-neutral-600 mt-1">Quantity: {{.Quantity}}</p>
            </div>

            <!-- Price -->
            <div class="text-right flex-shrink-0">
              <p class="text-sm font-medium text-neutral-900">
                ${{printf "%.2f" (divf .LineSubtotal 100.0)}}
              </p>
              <p class="text-xs text-neutral-600 mt-1">
                ${{printf "%.2f" (divf .UnitPriceCents 100.0)}} each
              </p>
            </div>
          </div>
          {{end}}
        </div>
      </div>

      <!-- Order Summary -->
      <div class="space-y-2 border-t border-neutral-200 pt-4 mb-6">
        <div class="flex justify-between text-sm">
          <span class="text-neutral-600">Subtotal</span>
          <span class="text-neutral-900">${{printf "%.2f" (divf .Order.SubtotalCents 100.0)}}</span>
        </div>
        <div class="flex justify-between text-sm">
          <span class="text-neutral-600">Shipping</span>
          <span class="text-neutral-900">${{printf "%.2f" (divf .Order.ShippingCents 100.0)}}</span>
        </div>
        <div class="flex justify-between text-sm">
          <span class="text-neutral-600">Tax</span>
          <span class="text-neutral-900">${{printf "%.2f" (divf .Order.TaxCents 100.0)}}</span>
        </div>
        <div class="flex justify-between border-t border-neutral-200 pt-4">
          <span class="text-base font-semibold text-neutral-900">Total</span>
          <span class="text-base font-semibold text-neutral-900">
            ${{printf "%.2f" (divf .Order.TotalCents 100.0)}}
          </span>
        </div>
      </div>

      <!-- Shipping & Billing Addresses -->
      <div class="grid sm:grid-cols-2 gap-6 border-t border-neutral-200 pt-6">
        <!-- Shipping Address -->
        <div>
          <h3 class="text-sm font-medium text-neutral-900 mb-2">Shipping Address</h3>
          <div class="text-sm text-neutral-600 space-y-1">
            <p>{{.ShippingAddress.Name}}</p>
            <p>{{.ShippingAddress.Address1}}</p>
            {{if .ShippingAddress.Address2}}
            <p>{{.ShippingAddress.Address2}}</p>
            {{end}}
            <p>{{.ShippingAddress.City}}, {{.ShippingAddress.State}} {{.ShippingAddress.PostalCode}}</p>
          </div>
        </div>

        <!-- Billing Address -->
        <div>
          <h3 class="text-sm font-medium text-neutral-900 mb-2">Billing Address</h3>
          {{if .Order.BillingAddressSameAsShipping}}
          <p class="text-sm text-neutral-600">Same as shipping address</p>
          {{else}}
          <div class="text-sm text-neutral-600 space-y-1">
            <p>{{.BillingAddress.Name}}</p>
            <p>{{.BillingAddress.Address1}}</p>
            {{if .BillingAddress.Address2}}
            <p>{{.BillingAddress.Address2}}</p>
            {{end}}
            <p>{{.BillingAddress.City}}, {{.BillingAddress.State}} {{.BillingAddress.PostalCode}}</p>
          </div>
          {{end}}
        </div>
      </div>

    </div>

    <!-- Next Steps -->
    <div class="bg-white border border-neutral-200 rounded-lg shadow-sm p-6 mb-8">
      <h2 class="text-lg font-semibold text-neutral-900 mb-4">What's Next?</h2>
      <div class="space-y-3 text-sm text-neutral-600">
        <div class="flex gap-3">
          <div class="flex-shrink-0 w-6 h-6 rounded-full bg-teal-100 text-teal-700 flex items-center justify-center text-xs font-medium">
            1
          </div>
          <p>You'll receive an order confirmation email shortly at <span class="font-medium text-neutral-900">{{.Order.Email}}</span></p>
        </div>
        <div class="flex gap-3">
          <div class="flex-shrink-0 w-6 h-6 rounded-full bg-teal-100 text-teal-700 flex items-center justify-center text-xs font-medium">
            2
          </div>
          <p>We'll send you a shipping notification with tracking information when your order ships</p>
        </div>
        <div class="flex gap-3">
          <div class="flex-shrink-0 w-6 h-6 rounded-full bg-teal-100 text-teal-700 flex items-center justify-center text-xs font-medium">
            3
          </div>
          <p>Expect delivery within 2-5 business days depending on your shipping method</p>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="flex flex-col sm:flex-row gap-4">
      {{if .User}}
      <a href="/account/orders/{{.Order.OrderNumber}}" class="inline-flex items-center justify-center gap-2 px-6 py-3 rounded-md font-medium bg-teal-700 text-white hover:bg-teal-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-700 shadow-sm transition-colors text-center">
        View Order Details
      </a>
      {{end}}
      <a href="/products" class="inline-flex items-center justify-center gap-2 px-6 py-3 rounded-md font-medium bg-white text-neutral-900 border border-neutral-300 hover:bg-neutral-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-700 transition-colors text-center">
        Continue Shopping
      </a>
    </div>

    <!-- Help Text -->
    <div class="mt-8 text-center">
      <p class="text-sm text-neutral-600">
        Questions about your order?
        <a href="/contact" class="text-teal-700 hover:text-teal-800 font-medium">Contact us</a>
      </p>
    </div>

    {{else}}
    <!-- Payment Failed State -->
    <div class="text-center mb-10">
      <div class="inline-flex items-center justify-center w-20 h-20 bg-red-100 rounded-full mb-6 shadow-sm">
        <svg class="w-12 h-12 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </div>
      {{template "sf-heading" (dict "Level" "1" "Content" "Payment Failed" "Class" "mb-3")}}
      <p class="text-base text-neutral-600 mb-6">
        We couldn't process your payment. Please try again.
      </p>
      <a href="/cart" class="inline-flex items-center justify-center gap-2 px-6 py-3 rounded-md font-medium bg-teal-700 text-white hover:bg-teal-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-700 shadow-sm transition-colors">
        Return to Cart
      </a>
    </div>
    {{end}}

  </div>
</div>
{{end}}
