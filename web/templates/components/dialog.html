{{/*
  Dialog/Modal Component - Catalyst UI Kit Style

  Usage:
    {{template "dialog" (dict
      "ID" "confirm-delete"
      "Title" "Delete Item"
      "Description" "Are you sure you want to delete this item?"
      "Body" "This action cannot be undone."
      "Size" "md"
      "Actions" (list
        (dict "Content" "Cancel" "Variant" "outline" "OnClick" "close")
        (dict "Content" "Delete" "Variant" "solid" "Color" "red" "Type" "submit")
      )
    )}}

  Parameters:
    - ID: Unique dialog identifier (required)
    - Title: Dialog title (required)
    - Description: Optional description text
    - Body: Dialog content (HTML or text)
    - Size: sm, md, lg, xl, full (default: "md")
    - Actions: List of button objects
    - ShowClose: Show close button (default: true)

  Opening the dialog:
    - Dispatch event: @click="$dispatch('open-dialog-{{.ID}}')"
    - Or set Alpine data: x-on:open-dialog-{{.ID}}.window="open = true"
*/}}

{{define "dialog"}}
<div x-data="{ open: false }"
     x-on:open-dialog-{{.ID}}.window="open = true"
     x-on:close-dialog-{{.ID}}.window="open = false"
     x-on:keydown.escape.window="open && (open = false)"
     x-cloak>

  <!-- Backdrop -->
  <div x-show="open"
       x-transition:enter="transition-opacity ease-out duration-200"
       x-transition:enter-start="opacity-0"
       x-transition:enter-end="opacity-100"
       x-transition:leave="transition-opacity ease-in duration-150"
       x-transition:leave-start="opacity-100"
       x-transition:leave-end="opacity-0"
       class="fixed inset-0 z-50 bg-zinc-950/25 dark:bg-zinc-950/50"></div>

  <!-- Dialog container -->
  <div x-show="open"
       x-transition:enter="transition ease-out duration-200"
       x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
       x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
       x-transition:leave="transition ease-in duration-150"
       x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
       x-transition:leave-end="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
       class="fixed inset-0 z-50 flex items-end sm:items-center justify-center p-0 sm:p-4">

    <!-- Dialog -->
    <div @click.away="open = false"
         class="relative w-full {{template "dialog-size" .Size}}
                rounded-t-3xl sm:rounded-3xl bg-white shadow-lg
                dark:bg-zinc-900 dark:ring-1 dark:ring-white/10
                max-h-[90vh] overflow-y-auto">

      <!-- Header with close button -->
      <div class="sticky top-0 bg-white dark:bg-zinc-900 p-6 sm:p-8
                  border-b border-zinc-950/5 dark:border-white/5">
        <div class="flex items-start justify-between">
          <div class="flex-1">
            <h2 class="text-2xl/8 font-semibold text-zinc-950 dark:text-white">
              {{.Title}}
            </h2>
            {{if .Description}}
              <p class="mt-2 text-base/6 text-zinc-500 dark:text-zinc-400">
                {{.Description}}
              </p>
            {{end}}
          </div>

          {{if or (not (index . "ShowClose")) .ShowClose}}
            <button @click="open = false"
                    type="button"
                    class="ml-4 text-zinc-400 hover:text-zinc-950
                           dark:hover:text-white transition-colors">
              <svg class="size-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          {{end}}
        </div>
      </div>

      <!-- Dialog body -->
      <div class="p-6 sm:p-8">
        {{.Body}}
      </div>

      <!-- Dialog actions -->
      {{if .Actions}}
        <div class="sticky bottom-0 bg-white dark:bg-zinc-900 px-6 py-4 sm:px-8 sm:py-6
                    border-t border-zinc-950/5 dark:border-white/5
                    flex flex-col-reverse gap-3 sm:flex-row sm:justify-end">
          {{range .Actions}}
            {{if eq .OnClick "close"}}
              <button @click="open = false"
                      type="{{or .Type "button"}}"
                      class="{{template "button-classes" .}}">
                {{.Content}}
              </button>
            {{else}}
              {{template "button" .}}
            {{end}}
          {{end}}
        </div>
      {{end}}
    </div>
  </div>
</div>
{{end}}

{{define "dialog-size"}}
{{if eq . "sm"}}max-w-sm
{{else if eq . "md"}}max-w-md
{{else if eq . "lg"}}max-w-lg
{{else if eq . "xl"}}max-w-xl
{{else if eq . "2xl"}}max-w-2xl
{{else if eq . "full"}}max-w-7xl
{{else}}max-w-md{{end}}
{{end}}
