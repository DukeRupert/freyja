{{define "title"}}Order {{.Order.OrderNumber}}{{end}}

{{define "content"}}
<div class="space-y-8">
    <!-- Back Link -->
    <div>
        <a href="/admin/orders"
           class="inline-flex items-center gap-2 text-sm/6 text-zinc-500 hover:text-zinc-950 dark:text-zinc-400 dark:hover:text-white">
            ‚Üê Back to Orders
        </a>
    </div>

    <!-- Page Header with Actions -->
    <div class="flex items-start justify-between">
        <div>
            {{template "heading" (dict "Level" "2" "Content" (printf "Order %s" .Order.OrderNumber))}}
            <p class="mt-2 text-base/7 text-zinc-600 dark:text-zinc-400">
                Placed on {{.Order.CreatedAt.Time.Format "January 2, 2006"}}
            </p>
        </div>
        {{if eq .Order.Status "pending"}}
        <form method="POST" action="/admin/orders/{{.Order.ID}}/status">
            <input type="hidden" name="status" value="processing">
            {{template "button" (dict
                "Content" "Mark Processing"
                "Type" "submit"
                "Variant" "solid"
                "Color" "blue")}}
        </form>
        {{end}}
    </div>

    <div class="grid gap-8 lg:grid-cols-3">
        <!-- Main Content (2/3 width) -->
        <div class="space-y-8 lg:col-span-2">
            <!-- Order Items -->
            <section class="rounded-2xl bg-white p-6 ring-1 ring-zinc-950/5 dark:bg-zinc-900 dark:ring-white/10">
                {{template "heading" (dict "Level" "3" "Content" "Order Items")}}

                <div class="mt-6 overflow-x-auto">
                    <table class="min-w-full text-left text-sm/6 text-zinc-950 dark:text-white">
                        <thead class="text-zinc-500 dark:text-zinc-400">
                            <tr>
                                <th class="px-4 py-3 font-medium">Product</th>
                                <th class="px-4 py-3 font-medium">SKU</th>
                                <th class="px-4 py-3 font-medium text-right">Qty</th>
                                <th class="px-4 py-3 font-medium text-right">Price</th>
                                <th class="px-4 py-3 font-medium text-right">Total</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-zinc-950/5 dark:divide-white/5">
                            {{range .OrderItems}}
                            <tr>
                                <td class="px-4 py-3">
                                    <div class="font-medium">{{.ProductName}}</div>
                                    {{if .VariantDescription.Valid}}
                                    <div class="text-sm text-zinc-500 dark:text-zinc-400">
                                        {{.VariantDescription.String}}
                                    </div>
                                    {{end}}
                                </td>
                                <td class="px-4 py-3 text-zinc-600 dark:text-zinc-400">{{.Sku}}</td>
                                <td class="px-4 py-3 text-right">{{.Quantity}}</td>
                                <td class="px-4 py-3 text-right">
                                    ${{printf "%.2f" (divf (add .UnitPriceCents 0.0) 100.0)}}
                                </td>
                                <td class="px-4 py-3 text-right font-medium">
                                    ${{printf "%.2f" (divf (add .TotalPriceCents 0.0) 100.0)}}
                                </td>
                            </tr>
                            {{end}}
                        </tbody>
                        <tfoot class="border-t-2 border-zinc-950/10 dark:border-white/10">
                            <tr>
                                <td colspan="4" class="px-4 py-2 text-right text-zinc-600 dark:text-zinc-400">
                                    Subtotal
                                </td>
                                <td class="px-4 py-2 text-right font-medium">
                                    ${{printf "%.2f" (divf (add .Order.SubtotalCents 0.0) 100.0)}}
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4" class="px-4 py-2 text-right text-zinc-600 dark:text-zinc-400">
                                    Shipping
                                </td>
                                <td class="px-4 py-2 text-right font-medium">
                                    ${{printf "%.2f" (divf (add .Order.ShippingCents 0.0) 100.0)}}
                                </td>
                            </tr>
                            <tr>
                                <td colspan="4" class="px-4 py-3 text-right font-semibold">
                                    Total
                                </td>
                                <td class="px-4 py-3 text-right text-lg font-semibold">
                                    ${{printf "%.2f" (divf (add .Order.TotalCents 0.0) 100.0)}}
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </section>

            <!-- Shipments -->
            {{if .Shipments}}
            <section class="rounded-2xl bg-white p-6 ring-1 ring-zinc-950/5 dark:bg-zinc-900 dark:ring-white/10">
                {{template "heading" (dict "Level" "3" "Content" "Shipments")}}

                <div class="mt-6 space-y-4">
                    {{range .Shipments}}
                    <div class="rounded-lg border border-zinc-950/10 p-4 dark:border-white/10">
                        <div class="flex items-start justify-between">
                            <div>
                                <div class="font-medium">{{.Carrier}}</div>
                                {{if .TrackingNumber.Valid}}
                                <div class="mt-1 text-sm text-zinc-600 dark:text-zinc-400">
                                    Tracking: {{.TrackingNumber.String}}
                                </div>
                                {{end}}
                            </div>
                            {{template "badge" (dict "Content" .Status "Color" "blue")}}
                        </div>
                        {{if .ShippedAt.Valid}}
                        <div class="mt-2 text-sm text-zinc-500 dark:text-zinc-400">
                            Shipped on {{.ShippedAt.Time.Format "Jan 2, 2006"}}
                        </div>
                        {{end}}
                    </div>
                    {{end}}
                </div>
            </section>
            {{end}}
        </div>

        <!-- Sidebar (1/3 width) -->
        <div class="space-y-6">
            <!-- Order Status -->
            <section class="rounded-2xl bg-white p-6 ring-1 ring-zinc-950/5 dark:bg-zinc-900 dark:ring-white/10">
                {{template "heading" (dict "Level" "3" "Content" "Status")}}

                <div class="mt-4 space-y-3">
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-zinc-600 dark:text-zinc-400">Order Status</span>
                        {{if eq .Order.Status "pending"}}
                            {{template "badge" (dict "Content" "Pending" "Color" "amber")}}
                        {{else if eq .Order.Status "processing"}}
                            {{template "badge" (dict "Content" "Processing" "Color" "blue")}}
                        {{else if eq .Order.Status "shipped"}}
                            {{template "badge" (dict "Content" "Shipped" "Color" "green")}}
                        {{else}}
                            {{template "badge" (dict "Content" .Order.Status "Color" "zinc")}}
                        {{end}}
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-zinc-600 dark:text-zinc-400">Order Type</span>
                        <span class="text-sm font-medium capitalize">{{.Order.OrderType}}</span>
                    </div>
                </div>
            </section>

            <!-- Customer Info -->
            <section class="rounded-2xl bg-white p-6 ring-1 ring-zinc-950/5 dark:bg-zinc-900 dark:ring-white/10">
                {{template "heading" (dict "Level" "3" "Content" "Customer")}}

                <div class="mt-4 space-y-2">
                    {{if .Order.CustomerEmail.Valid}}
                    <div>
                        <div class="text-sm text-zinc-600 dark:text-zinc-400">Email</div>
                        <div class="mt-1">{{.Order.CustomerEmail.String}}</div>
                    </div>
                    {{end}}
                </div>
            </section>

            <!-- Shipping Address -->
            {{if or .Order.ShippingAddressLine1.Valid .Order.ShippingCity.Valid}}
            <section class="rounded-2xl bg-white p-6 ring-1 ring-zinc-950/5 dark:bg-zinc-900 dark:ring-white/10">
                {{template "heading" (dict "Level" "3" "Content" "Shipping Address")}}

                <div class="mt-4 text-sm">
                    {{if .Order.ShippingAddressLine1.Valid}}
                    <div>{{.Order.ShippingAddressLine1.String}}</div>
                    {{end}}
                    {{if .Order.ShippingAddressLine2.Valid}}
                    <div>{{.Order.ShippingAddressLine2.String}}</div>
                    {{end}}
                    <div>
                        {{if .Order.ShippingCity.Valid}}{{.Order.ShippingCity.String}}, {{end}}
                        {{if .Order.ShippingState.Valid}}{{.Order.ShippingState.String}} {{end}}
                        {{if .Order.ShippingPostalCode.Valid}}{{.Order.ShippingPostalCode.String}}{{end}}
                    </div>
                    {{if .Order.ShippingCountry.Valid}}
                    <div>{{.Order.ShippingCountry.String}}</div>
                    {{end}}
                </div>
            </section>
            {{end}}
        </div>
    </div>
</div>
{{end}}
