{{define "title"}}Dashboard{{end}}

{{define "content"}}
<div class="space-y-8">
    <!-- Page Header -->
    {{template "page-header" (dict
        "Title" "Dashboard"
        "Description" "Overview of your coffee roasting business")}}

    <!-- Onboarding Checklist Widget -->
    {{if .Onboarding}}
    {{template "onboarding-widget" .Onboarding}}
    {{end}}

    <!-- Stats Grid -->
    <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-4">
        {{template "stat-card" (dict
            "Label" "Total Orders"
            "Value" .OrderStats.TotalOrders
            "Description" "Last 30 days")}}

        {{template "stat-card" (dict
            "Label" "Pending Orders"
            "Value" .OrderStats.PendingOrders
            "Description" "Requires attention"
            "Color" "amber")}}

        {{template "stat-card" (dict
            "Label" "Revenue"
            "Value" (printf "$%s" .OrderStats.TotalRevenueDollars)
            "Description" "Last 30 days")}}

        {{template "stat-card" (dict
            "Label" "Total Customers"
            "Value" .UserStats.TotalUsers
            "Description" (printf "%v retail / %v wholesale" .UserStats.RetailUsers .UserStats.WholesaleUsers))}}
    </div>

    <!-- Recent Orders -->
    <section class="rounded-2xl bg-white ring-1 ring-zinc-950/5 dark:bg-zinc-900 dark:ring-white/10">
        <div class="border-b border-zinc-950/5 px-6 py-4 dark:border-white/5">
            {{template "heading" (dict "Level" "3" "Content" "Recent Orders")}}
        </div>

        {{if .RecentOrders}}
        <div class="overflow-x-auto">
            <table class="min-w-full text-left text-sm/6 text-zinc-950 dark:text-white">
                <thead class="text-zinc-500 dark:text-zinc-400">
                    <tr>
                        <th class="px-6 py-3 font-medium">Order</th>
                        <th class="px-6 py-3 font-medium">Customer</th>
                        <th class="px-6 py-3 font-medium">Status</th>
                        <th class="px-6 py-3 font-medium">Total</th>
                        <th class="px-6 py-3 font-medium">Date</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-zinc-950/5 dark:divide-white/5">
                    {{range .RecentOrders}}
                    <tr class="hover:bg-zinc-950/[2.5%] dark:hover:bg-white/[2.5%]">
                        <td class="px-6 py-4">
                            <a href="/admin/orders/{{.ID}}"
                               class="font-medium text-zinc-950 hover:text-zinc-700 dark:text-white dark:hover:text-zinc-300">
                                {{.OrderNumber}}
                            </a>
                        </td>
                        <td class="px-6 py-4 text-zinc-600 dark:text-zinc-400">
                            {{if .CustomerName}}{{.CustomerName}}{{else}}Guest{{end}}
                        </td>
                        <td class="px-6 py-4">
                            {{if eq .Status "pending"}}
                                {{template "badge" (dict "Content" "Pending" "Color" "amber")}}
                            {{else if eq .Status "processing"}}
                                {{template "badge" (dict "Content" "Processing" "Color" "blue")}}
                            {{else if eq .Status "shipped"}}
                                {{template "badge" (dict "Content" "Shipped" "Color" "green")}}
                            {{else}}
                                {{template "badge" (dict "Content" .Status "Color" "zinc")}}
                            {{end}}
                        </td>
                        <td class="px-6 py-4 text-zinc-950 dark:text-white">
                            ${{.TotalDollars}}
                        </td>
                        <td class="px-6 py-4 text-zinc-500 dark:text-zinc-400">
                            {{.CreatedAtFormatted}}
                        </td>
                    </tr>
                    {{end}}
                </tbody>
            </table>
        </div>
        <div class="border-t border-zinc-950/5 px-6 py-4 dark:border-white/5">
            <a href="/admin/orders"
               class="text-sm/6 font-medium text-zinc-950 hover:text-zinc-700 dark:text-white dark:hover:text-zinc-300">
                View all orders â†’
            </a>
        </div>
        {{else}}
        {{template "empty-state" (dict
            "Title" "No orders yet"
            "Description" "Orders will appear here once customers start purchasing your products")}}
        {{end}}
    </section>

    <!-- Pending Wholesale Applications -->
    {{if gt .UserStats.PendingApplications 0}}
    <div class="rounded-2xl bg-amber-50 p-6 ring-1 ring-amber-600/20 dark:bg-amber-500/10 dark:ring-amber-500/20">
        {{template "heading" (dict "Level" "3" "Content" "Pending Wholesale Applications")}}
        <p class="mt-2 text-base/7 text-amber-900 dark:text-amber-300">
            You have {{.UserStats.PendingApplications}} wholesale application(s) waiting for review.
        </p>
        <div class="mt-6">
            {{template "button" (dict
                "Content" "Review Applications"
                "Variant" "solid"
                "Color" "amber"
                "HXGet" "/admin/customers?filter=wholesale_pending")}}
        </div>
    </div>
    {{end}}
</div>
{{end}}
